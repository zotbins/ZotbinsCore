<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.14.0" xml:lang="en-US">
  <compounddef id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture" kind="page">
    <compoundname>md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture</compoundname>
    <title>Software Architecture</title>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para><anchor id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md8"/></para>
<sect1 id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md9">
<title>Introduction</title><para>The purpose of this document is to provide a detailed overview of the software architecture behind the new ZotBins Core, focusing on reliability, maintainability, and efficiency.</para>
<para>The intention of this document is to help the embedded system development team understand how the system is structured.</para>
</sect1>
<sect1 id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md10">
<title>Background</title><para>ZotBins Core is a IoT Smart Bin to keep track of waste data metrics like bin fullness, weight, usage rates, etc. This is intended to help quantify waste data and promote solutions to reduce the amount of waste people throw away.</para>
<para>The previous iteration was a Raspberry Pi-based system. This system is intended to a replacement for the Raspberry Pi system, while being more reliable, maintainable, efficient, and testable.</para>
</sect1>
<sect1 id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md11">
<title>Functional Requirements</title><para>Many of the features revolve around the various sensors that the ZotBins Core utilize.</para>
<para><itemizedlist>
<listitem><para>Breakbeam Sensor: Measure the amount of time a bin is used in a 30 minute time period</para>
</listitem><listitem><para>Load Cell &amp; HX-711: Measure the weight of the trash currently in the bin</para>
</listitem><listitem><para>Ultrasonic sensor: Measure the current fullness of the trash can</para>
</listitem></itemizedlist>
</para>
<para>Additionally, the system must publish the sensor data to a MQTT broker every 30 minutes.</para>
</sect1>
<sect1 id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md12">
<title>Architecture Overview</title><para>ZotBins Core is a RTOS application, where each function is divided into a separate task to optimize the efficiency and relability of the system. Each sensor has its own task and in the off chance the sensor fails, the overall system can still function as intended.</para>
<para>Each sensor task will pass its sensor data to the MQTT task through a thread-safe queue, so the MQTT Task can publish its sensor data to the MQTT broker.</para>
<para>This system of having a task for each sensor makes the system more maintainable due to separation of concerns. The fullness task does not need to worry about the state of the weight task and can just focus on itself. In addition, the system is more extensible since a new task can be easily added to the system without interfering with the other features.</para>
<sect2 id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md13_1s2"><sect3 id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md13">
<title>Overall System Diagram (more detail on each task is shown down below)</title></sect3></sect2>
<sect2 id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md14">
<title>Fullness Task</title><para>The <ref refid="namespace_fullness" kindref="compound">Fullness</ref> Task is responsible for measuring the current fullness of the waste bin. This is measured by the following equation. The height of the waste bin should be hard coded for each ZotBins Core deployment as each bin might differ in height.</para>
<para><programlisting><codeline><highlight class="normal">Fullness<sp/>%<sp/>=<sp/>(Height<sp/>of<sp/>Bin<sp/>-<sp/>Distance<sp/>measured<sp/>from<sp/>ultrasonic<sp/>sensor)<sp/>/<sp/>Height<sp/>of<sp/>Bin</highlight></codeline>
</programlisting></para>
<para>If the ultrasonic sensor reads an invalid value, it should log the error and return a error value like <computeroutput>-1</computeroutput> so the MQTT thread is not blocked waiting for the fullness value.</para>
</sect2>
<sect2 id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md15">
<title>Weight Task</title><para>The <ref refid="namespace_weight" kindref="compound">Weight</ref> Task is responsible for measuring the current weight in kilograms of the waste bin. This is measured using load cells and the HX711 load cell amplifier for the MCU to read.</para>
<para>If an invalid weight is read from the HX711, or if the weight sensor is not performing as expected, we will log the error and send a corresponding error value to the queue, so the MQTT thread is not blocked waiting for the weight value.</para>
</sect2>
<sect2 id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md16">
<title>Usage Task</title><para>TODO</para>
</sect2>
<sect2 id="md__c_1_2priya_2_zot_bins_2_zotbins_core_2docs_2sw__architecture_1autotoc_md17">
<title>MQTT Task</title><para>TODO </para>
</sect2>
</sect1>
    </detaileddescription>
    <location file="C:/priya/ZotBins/ZotbinsCore/docs/sw_architecture.md"/>
  </compounddef>
</doxygen>

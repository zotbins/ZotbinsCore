<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.14.0" xml:lang="en-US">
  <compounddef id="weight_task_8cpp" kind="file" language="C++">
    <compoundname>weightTask.cpp</compoundname>
    <includes refid="weight_task_8hpp" local="yes">weightTask.hpp</includes>
    <includes refid="_real_weight_8hpp" local="yes">RealWeight.hpp</includes>
    <includes refid="_weight_metric_8hpp" local="yes">WeightMetric.hpp</includes>
    <includes local="yes">esp_log.h</includes>
    <includes local="yes">nvs_flash.h</includes>
    <incdepgraph>
      <node id="6">
        <label>task.hpp</label>
        <link refid="task_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>weightTask.hpp</label>
        <link refid="weight_task_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>weightTask.cpp</label>
        <link refid="weight_task_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>IWeight.hpp</label>
        <link refid="_i_weight_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>RealWeight.hpp</label>
        <link refid="_real_weight_8hpp"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>WeightMetric.hpp</label>
        <link refid="_weight_metric_8hpp"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>hx711.h</label>
        <link refid="hx711_8h"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>cstdint</label>
      </node>
      <node id="11">
        <label>driver/gpio.h</label>
      </node>
      <node id="13">
        <label>esp_err.h</label>
      </node>
      <node id="15">
        <label>esp_log.h</label>
      </node>
      <node id="3">
        <label>freertos/FreeRTOS.h</label>
      </node>
      <node id="4">
        <label>freertos/queue.h</label>
      </node>
      <node id="5">
        <label>freertos/task.h</label>
      </node>
      <node id="16">
        <label>nvs_flash.h</label>
      </node>
      <node id="12">
        <label>stdbool.h</label>
      </node>
    </incdepgraph>
    <sectiondef kind="var">
      <memberdef kind="variable" id="weight_task_8cpp_1abab40657d82602983bf8c633397b8c37" prot="public" static="no" mutable="no">
        <type>const gpio_num_t</type>
        <definition>const gpio_num_t PIN_DOUT</definition>
        <argsstring></argsstring>
        <name>PIN_DOUT</name>
        <initializer>= GPIO_NUM_2</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp" line="9" column="18" bodyfile="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp" bodystart="9" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="weight_task_8cpp_1abd319357e6be9ea7507c53f0da16ffd5" prot="public" static="no" mutable="no">
        <type>const gpio_num_t</type>
        <definition>const gpio_num_t PIN_PD_SCK</definition>
        <argsstring></argsstring>
        <name>PIN_PD_SCK</name>
        <initializer>= GPIO_NUM_14</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp" line="10" column="18" bodyfile="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp" bodystart="10" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="weight_task_8cpp_1a8f8f80d37794cde9472343e4487ba3eb" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* name</definition>
        <argsstring></argsstring>
        <name>name</name>
        <initializer>= &quot;weightTask&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp" line="12" column="19" bodyfile="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp" bodystart="12" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="weight_task_8cpp_1a47b03cec33388ca17717791b81c634bc" prot="public" static="yes" mutable="no">
        <type>const int</type>
        <definition>const int priority</definition>
        <argsstring></argsstring>
        <name>priority</name>
        <initializer>= 1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp" line="13" column="18" bodyfile="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp" bodystart="13" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="weight_task_8cpp_1a0dfea47b4bb6f03a7066171bc0c83054" prot="public" static="yes" mutable="no">
        <type>const uint32_t</type>
        <definition>const uint32_t stackSize</definition>
        <argsstring></argsstring>
        <name>stackSize</name>
        <initializer>= 4096</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp" line="14" column="23" bodyfile="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp" bodystart="14" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#include<sp/>&quot;<ref refid="weight_task_8hpp" kindref="compound">weightTask.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_real_weight_8hpp" kindref="compound">RealWeight.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_weight_metric_8hpp" kindref="compound">WeightMetric.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;esp_log.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;nvs_flash.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespace_zotbins" kindref="compound">Zotbins</ref>;</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9" refid="weight_task_8cpp_1abab40657d82602983bf8c633397b8c37" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gpio_num_t<sp/><ref refid="weight_task_8cpp_1abab40657d82602983bf8c633397b8c37" kindref="member">PIN_DOUT</ref><sp/>=<sp/>GPIO_NUM_2;</highlight></codeline>
<codeline lineno="10" refid="weight_task_8cpp_1abd319357e6be9ea7507c53f0da16ffd5" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>gpio_num_t<sp/><ref refid="weight_task_8cpp_1abd319357e6be9ea7507c53f0da16ffd5" kindref="member">PIN_PD_SCK</ref><sp/>=<sp/>GPIO_NUM_14;</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12" refid="weight_task_8cpp_1a8f8f80d37794cde9472343e4487ba3eb" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="camera_task_8cpp_1a8f8f80d37794cde9472343e4487ba3eb" kindref="member">name</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;weightTask&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="13" refid="weight_task_8cpp_1a47b03cec33388ca17717791b81c634bc" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="camera_task_8cpp_1a47b03cec33388ca17717791b81c634bc" kindref="member">priority</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="14" refid="weight_task_8cpp_1a0dfea47b4bb6f03a7066171bc0c83054" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/><ref refid="camera_task_8cpp_1a0dfea47b4bb6f03a7066171bc0c83054" kindref="member">stackSize</ref><sp/>=<sp/>4096;</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="class_zotbins_1_1_weight_task_1a0e8a35c46fab6a95950b2c7b8266d9cc" refkind="member"><highlight class="normal"><ref refid="class_zotbins_1_1_weight_task_1a0e8a35c46fab6a95950b2c7b8266d9cc" kindref="member">WeightTask::WeightTask</ref>(QueueHandle_t<sp/>&amp;messageQueue)</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/>:<sp/><ref refid="class_zotbins_1_1_task_1aac7494327c74bcd8bf14fb00a755b00e" kindref="member">Task</ref>(<ref refid="camera_task_8cpp_1a8f8f80d37794cde9472343e4487ba3eb" kindref="member">name</ref>,<sp/><ref refid="camera_task_8cpp_1a47b03cec33388ca17717791b81c634bc" kindref="member">priority</ref>,<sp/><ref refid="camera_task_8cpp_1a0dfea47b4bb6f03a7066171bc0c83054" kindref="member">stackSize</ref>),<sp/><ref refid="class_zotbins_1_1_weight_task_1ac17d1bbb5d4eb8867cc9ddc6c912089d" kindref="member">mMessageQueue</ref>(messageQueue)</highlight></codeline>
<codeline lineno="18"><highlight class="normal">{</highlight></codeline>
<codeline lineno="19"><highlight class="normal">}</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21" refid="class_zotbins_1_1_weight_task_1a778cdf289a705dba5daec29e325583d8" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_zotbins_1_1_weight_task_1a778cdf289a705dba5daec29e325583d8" kindref="member">WeightTask::start</ref>()</highlight></codeline>
<codeline lineno="22"><highlight class="normal">{</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/>xTaskCreate(<ref refid="class_zotbins_1_1_weight_task_1afed811b41d6b31224046e17a2f4cc762" kindref="member">taskFunction</ref>,<sp/><ref refid="class_zotbins_1_1_task_1a66bd8c1720804bce64146ccfc0446a78" kindref="member">mName</ref>,<sp/><ref refid="class_zotbins_1_1_task_1ae389a070ae6bde070b9770e173fdbed3" kindref="member">mStackSize</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/><ref refid="class_zotbins_1_1_task_1a84584bfe090c4c3fb388c6cbb100dce8" kindref="member">mPriority</ref>,<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="24"><highlight class="normal">}</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26" refid="class_zotbins_1_1_weight_task_1afed811b41d6b31224046e17a2f4cc762" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_zotbins_1_1_weight_task_1afed811b41d6b31224046e17a2f4cc762" kindref="member">WeightTask::taskFunction</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*task)</highlight></codeline>
<codeline lineno="27"><highlight class="normal">{</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_zotbins_1_1_weight_task_1a0e8a35c46fab6a95950b2c7b8266d9cc" kindref="member">WeightTask</ref><sp/>*weightTask<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="normal"><ref refid="class_zotbins_1_1_weight_task_1a0e8a35c46fab6a95950b2c7b8266d9cc" kindref="member">WeightTask</ref><sp/>*</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(task);</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/>weightTask-&gt;<ref refid="class_zotbins_1_1_weight_task_1ab91a9f483e5e45f077040aab7ac89da6" kindref="member">setup</ref>();</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/>weightTask-&gt;<ref refid="class_zotbins_1_1_weight_task_1a331b69468dd4b05c8490217268460df1" kindref="member">loop</ref>();</highlight></codeline>
<codeline lineno="31"><highlight class="normal">}</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33" refid="class_zotbins_1_1_weight_task_1ab91a9f483e5e45f077040aab7ac89da6" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_zotbins_1_1_weight_task_1ab91a9f483e5e45f077040aab7ac89da6" kindref="member">WeightTask::setup</ref>()</highlight></codeline>
<codeline lineno="34"><highlight class="normal">{</highlight></codeline>
<codeline lineno="35"><highlight class="normal">}</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37" refid="class_zotbins_1_1_weight_task_1a331b69468dd4b05c8490217268460df1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_zotbins_1_1_weight_task_1a331b69468dd4b05c8490217268460df1" kindref="member">WeightTask::loop</ref>()</highlight></codeline>
<codeline lineno="38"><highlight class="normal">{</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_weight_1_1_real_weight" kindref="compound">Weight::RealWeight</ref><sp/>weight_source;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_weight_1_1_weight_metric" kindref="compound">Weight::WeightMetric</ref><sp/>wm(weight_source);</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/>int32_t<sp/>weight_raw;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>weight;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/>int32_t<sp/>tare_factor;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/>int32_t<sp/>calibration_factor;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>ready;<sp/></highlight><highlight class="comment">//<sp/>variable<sp/>storing<sp/>the<sp/>status<sp/>of<sp/>the<sp/>weight<sp/>sensor<sp/>measurement<sp/>(measurement<sp/>ready<sp/>to<sp/>be<sp/>read<sp/>or<sp/>not)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>tare_factor_initialized;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>calibration_factor_initialized;<sp/></highlight><highlight class="comment">//<sp/>factor<sp/>to<sp/>scale<sp/>raw<sp/>weight<sp/>reading<sp/>to<sp/>grams</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__hx711_1gacadec7365abc52889994131164536304" kindref="member">hx711_gain_t</ref><sp/>gain_setting<sp/>=<sp/><ref refid="group__hx711_1ggacadec7365abc52889994131164536304ad2623c2ec7f23f70544973776139fe06" kindref="member">HX711_GAIN_A_128</ref>;</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structhx711__t" kindref="compound">hx711_t</ref><sp/>wm_sensor<sp/>=<sp/>{</highlight><highlight class="comment">//<sp/>construct<sp/>weight<sp/>object<sp/>that<sp/>specifies<sp/>the<sp/>pins<sp/>to<sp/>use<sp/>and<sp/>the<sp/>gain<sp/>of<sp/>the<sp/>hx711<sp/>amplifier</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.dout<sp/>=<sp/><ref refid="weight_task_8cpp_1abab40657d82602983bf8c633397b8c37" kindref="member">PIN_DOUT</ref>,</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.pd_sck<sp/>=<sp/><ref refid="weight_task_8cpp_1abd319357e6be9ea7507c53f0da16ffd5" kindref="member">PIN_PD_SCK</ref>,</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.gain<sp/>=<sp/>gain_setting};</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__hx711_1ga6ec30c654e419d67887caafb0a2f025b" kindref="member">hx711_init</ref>(&amp;wm_sensor);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>below<sp/>was<sp/>copied<sp/>and<sp/>modified<sp/>from<sp/>nvs_rw_value<sp/>under<sp/>storage<sp/>in<sp/>examples<sp/>(esp-idf<sp/>examples)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/>esp_err_t<sp/>err<sp/>=<sp/>nvs_flash_init();</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err<sp/>==<sp/>ESP_ERR_NVS_NO_FREE_PAGES<sp/>||<sp/>err<sp/>==<sp/>ESP_ERR_NVS_NEW_VERSION_FOUND)</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NVS<sp/>partition<sp/>was<sp/>truncated<sp/>and<sp/>needs<sp/>to<sp/>be<sp/>erased</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Retry<sp/>nvs_flash_init</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ESP_ERROR_CHECK(nvs_flash_erase());</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>nvs_flash_init();</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_ERROR_CHECK(err);</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Open</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Opening<sp/>Non-Volatile<sp/>Storage<sp/>(NVS)<sp/>handle...<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/>nvs_handle_t<sp/>my_handle;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/>err<sp/>=<sp/>nvs_open(</highlight><highlight class="stringliteral">&quot;storage&quot;</highlight><highlight class="normal">,<sp/>NVS_READWRITE,<sp/>&amp;my_handle);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err<sp/>!=<sp/>ESP_OK)</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Error<sp/>(%s)<sp/>opening<sp/>NVS<sp/>handle!\n&quot;</highlight><highlight class="normal">,<sp/>esp_err_to_name(err));</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Done\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Read</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Reading<sp/>restart<sp/>counter<sp/>from<sp/>NVS<sp/>...<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>int32_t<sp/>restart_counter<sp/>=<sp/>0;<sp/>//<sp/>value<sp/>will<sp/>default<sp/>to<sp/>0,<sp/>if<sp/>not<sp/>set<sp/>yet<sp/>in<sp/>NVS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>nvs_get_i32(my_handle,<sp/></highlight><highlight class="stringliteral">&quot;tare_factor&quot;</highlight><highlight class="normal">,<sp/>&amp;tare_factor);<sp/></highlight><highlight class="comment">//<sp/>checking<sp/>if<sp/>the<sp/>tare<sp/>factor<sp/>is<sp/>already<sp/>written<sp/>to<sp/>nvs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(err)</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>ESP_OK:</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Done\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Tare<sp/>factor<sp/>=<sp/>%&quot;</highlight><highlight class="normal"><sp/>PRIu32<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">,<sp/>tare_factor);</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tare_factor_initialized<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>ESP_ERR_NVS_NOT_FOUND:</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;The<sp/>value<sp/>is<sp/>not<sp/>initialized<sp/>yet!\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tare_factor_initialized<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Error<sp/>(%s)<sp/>reading!\n&quot;</highlight><highlight class="normal">,<sp/>esp_err_to_name(err));</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tare_factor_initialized<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//<sp/>skip<sp/>initializing,<sp/>something<sp/>wrong<sp/>with<sp/>accessing<sp/>the<sp/>tare_factor<sp/>from<sp/>nvs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>fix<sp/>calibration<sp/>factor<sp/>since<sp/>it&apos;s<sp/>causing<sp/>scale<sp/>to<sp/>not<sp/>work<sp/>properly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>nvs_get_i32(my_handle,<sp/></highlight><highlight class="stringliteral">&quot;calibration_factor&quot;</highlight><highlight class="normal">,<sp/>&amp;calibration_factor);<sp/></highlight><highlight class="comment">//<sp/>checking<sp/>if<sp/>the<sp/>calibration<sp/>factor<sp/>is<sp/>already<sp/>written<sp/>to<sp/>nvs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(err)</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>ESP_OK:</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Done\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Tare<sp/>factor<sp/>=<sp/>%&quot;</highlight><highlight class="normal"><sp/>PRIu32<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">,<sp/>calibration_factor);</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>calibration_factor_initialized<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>ESP_ERR_NVS_NOT_FOUND:</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;The<sp/>value<sp/>is<sp/>not<sp/>initialized<sp/>yet!\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>calibration_factor_initialized<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Error<sp/>(%s)<sp/>reading!\n&quot;</highlight><highlight class="normal">,<sp/>esp_err_to_name(err));</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>calibration_factor_initialized<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//<sp/>skip<sp/>initializing,<sp/>something<sp/>wrong<sp/>with<sp/>accessing<sp/>the<sp/>tare_factor<sp/>from<sp/>nvs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tare_factor_initialized<sp/>==<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="comment">//<sp/>if<sp/>the<sp/>tare_factor<sp/>has<sp/>not<sp/>already<sp/>been<sp/>set,<sp/>measured<sp/>and<sp/>set<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hx711_1gae4a20f39d8518f017bc252c381d1ab56" kindref="member">hx711_is_ready</ref>(&amp;wm_sensor,<sp/>&amp;ready);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!ready)</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__hx711_1ga9d0b417f2c7bad37f24e7c1a32149e0b" kindref="member">hx711_read_average</ref>(&amp;wm_sensor,<sp/>10,<sp/>&amp;tare_factor);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>the<sp/>raw<sp/>weight<sp/>when<sp/>there<sp/>is<sp/>nothing<sp/>on<sp/>the<sp/>sensor,<sp/>so<sp/>this<sp/>reading<sp/>can<sp/>be<sp/>considered<sp/>zero<sp/>weight<sp/>(tare).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>nvs_set_i32(my_handle,<sp/></highlight><highlight class="stringliteral">&quot;tare_factor&quot;</highlight><highlight class="normal">,<sp/>tare_factor);<sp/></highlight><highlight class="comment">//<sp/>write</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf((err<sp/>!=<sp/>ESP_OK)<sp/>?<sp/></highlight><highlight class="stringliteral">&quot;tare_factor<sp/>writing<sp/>failed!\n&quot;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;Done\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(calibration_factor_initialized<sp/>==<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="comment">//<sp/>if<sp/>the<sp/>tare_factor<sp/>has<sp/>not<sp/>already<sp/>been<sp/>set,<sp/>measured<sp/>and<sp/>set<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>TODO:<sp/>calibrate<sp/>-<sp/>idea<sp/>is<sp/>to<sp/>proceed<sp/>with<sp/>this<sp/>after<sp/>the<sp/>tare<sp/>factor<sp/>is<sp/>initialized,<sp/>and</highlight></codeline>
<codeline lineno="135"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>then<sp/>wait<sp/>for<sp/>a<sp/>significant<sp/>change<sp/>in<sp/>weight,<sp/>or<sp/>until<sp/>some<sp/>sort<sp/>of<sp/>input</highlight></codeline>
<codeline lineno="136"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(might<sp/>need<sp/>a<sp/>separate<sp/>pin<sp/>for<sp/>this<sp/>or<sp/>pause<sp/>all<sp/>the<sp/>other<sp/>tasks<sp/>to<sp/>avoid<sp/>pin<sp/>conflicts)</highlight></codeline>
<codeline lineno="137"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>then<sp/>get<sp/>the<sp/>calibration<sp/>factor<sp/>from<sp/>this.<sp/>or<sp/>we<sp/>can<sp/>meauser<sp/>it<sp/>and<sp/>write<sp/>it<sp/>directly</highlight></codeline>
<codeline lineno="138"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>into<sp/>nvs<sp/>using<sp/>a<sp/>constant<sp/>in<sp/>program<sp/>memory<sp/>but<sp/>that<sp/>is<sp/>messier</highlight></codeline>
<codeline lineno="139"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>calibration_factor<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>nvs_set_i32(my_handle,<sp/></highlight><highlight class="stringliteral">&quot;calibration_factor&quot;</highlight><highlight class="normal">,<sp/>calibration_factor);<sp/></highlight><highlight class="comment">//<sp/>write</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf((err<sp/>!=<sp/>ESP_OK)<sp/>?<sp/></highlight><highlight class="stringliteral">&quot;calibration_factor<sp/>writing<sp/>failed!\n&quot;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;Done\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Commit<sp/>wriing<sp/>any<sp/>values,<sp/>nvs_commit()<sp/>must<sp/>be<sp/>called<sp/>to<sp/>ensure<sp/>changes<sp/>are<sp/>written</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>to<sp/>flash<sp/>storage.<sp/>Implementations<sp/>may<sp/>write<sp/>to<sp/>storage<sp/>at<sp/>other<sp/>times,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>but<sp/>this<sp/>is<sp/>not<sp/>guaranteed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Committten<sp/>value.<sp/>After<sp/>settting<sp/>updates<sp/>in<sp/>NVS<sp/>...<sp/>&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/>nvs_commit(my_handle);</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf((err<sp/>!=<sp/>ESP_OK)<sp/>?<sp/></highlight><highlight class="stringliteral">&quot;Failed!\n&quot;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;Done\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Close</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nvs_close(my_handle);</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(1)</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vTaskDelay(1000<sp/>/<sp/>portTICK_PERIOD_MS);<sp/></highlight><highlight class="comment">//<sp/>Delay<sp/>for<sp/>1000<sp/>milliseconds</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ESP_LOGI(<ref refid="camera_task_8cpp_1a8f8f80d37794cde9472343e4487ba3eb" kindref="member">name</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Hello<sp/>from<sp/>Weight<sp/>Task<sp/>:<sp/>%d&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">int</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(wm.<ref refid="class_weight_1_1_weight_metric_1a5d0ab554c0b259295544c6cf8210d8ef" kindref="member">getWeight</ref>()));</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="162"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="C:/priya/ZotBins/ZotbinsCore/components/TaskComponent/weightTask.cpp"/>
  </compounddef>
</doxygen>
